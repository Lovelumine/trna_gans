### 相对位置向量计算公式

对于原子\(i\)和原子\(j\)，其3D坐标分别为\(\vec{p}_i\)和\(\vec{p}_j\)，相对位置向量\(\vec{v}_{ij}\)计算如下：

\[\vec{v}_{ij} = \vec{p}_j + \vec{o}_{ij} - \vec{p}_i\]

其中，\(\vec{o}_{ij}\)是根据周期性边界条件计算得到的偏移量，它通过原子间距离和晶格单元的大小确定。当不考虑周期性边界条件时，\(\vec{o}_{ij} = \vec{0}\)。

### 邻居列表和边索引构造

邻居列表和边索引通过以下过程构造：

1. 计算每对原子\(i, j\)之间的距离\(d_{ij}\)。
2. 如果\(d_{ij} \leq r_{\text{max}}\)，则原子\(j\)是原子\(i\)的邻居，其中\(r_{\text{max}}\)是预设的最大邻居距离。
3. 对于每个原子对\(i, j\)，满足上述条件的，将其加入邻居列表。

边索引\(E\)是一个两行的张量，其中每一列代表一条边，第一行是出发点（原子\(i\)的索引），第二行是终点（原子\(j\)的索引）：

\[E = \begin{bmatrix}i_1 & i_2 & \cdots & i_n \\j_1 & j_2 & \cdots & j_n\end{bmatrix}\]

其中，\(n\)是满足邻居条件的原子对的数量。

### 特征矩阵构造

给定一组原子，每个原子具有一个元素类型（如C, O, N, P），特征矩阵\(X\)的构造如下：

1. 首先为每种元素类型分配一个索引，例如C: 0, O: 1, N: 2, P: 3。
2. 对于每个原子，其特征向量\(x_i\)在对应元素类型的索引位置为1，其他位置为0。

\[
x_i = \begin{cases}
1, & \text{if atom } i \text{ is of type } k \\
0, & \text{otherwise}
\end{cases}
\]

特征矩阵\(X\)是一个\(M \times K\)的矩阵，其中\(M\)是原子的数量，\(K\)是元素类型的数量。
